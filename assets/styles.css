/* =========================================================
   PlantGo • Fresh Light Theme (v3)
   Drop‑in replacement for styles.css
   - Keeps your existing class/ID hooks
   - Big visual refresh: softer cards, bolder CTAs, clearer hierarchy
   - Motion-safe, accessible contrast, mobile‑first
   ========================================================= */

/* ---------------------------------------------------------
   0) Design Tokens
   --------------------------------------------------------- */
:root {
  /* Palette */
  --bg: #f9fafb;            /* app background */
  --surface: #ffffff;        /* cards / panels */
  --surface-2: #f3f4f6;      /* subtle fills */
  --text: #0f172a;           /* slate-900 */
  --muted: #667085;          /* gray-500/600 */
  --border: #e5e7eb;         /* gray-200 */

  /* Brand greens */
  --green-50:  #f0fdf4;
  --green-100: #dcfce7;
  --green-200: #bbf7d0;
  --green-300: #86efac;
  --green-400: #4ade80;
  --green-500: #22c55e;
  --green-600: #16a34a;
  --green-700: #15803d;
  --green-800: #166534;

  /* Semantics */
  --danger-100: #ffe4e6; --danger-500: #e11d48;
  --warn-100: #fff7ed;   --warn-600: #c2410c;
  --info-100: #eff6ff;   --info-600: #2563eb;

  /* Radii */
  --r-sm: 8px;   --r-md: 12px;  --r-lg: 16px;  --r-xl: 20px;  --r-2xl: 24px;  --r-pill: 999px;

  /* Spacing */
  --sp-1: 4px; --sp-2: 8px; --sp-3: 12px; --sp-4: 16px; --sp-5: 20px; --sp-6: 24px; --sp-7: 28px; --sp-8: 32px;

  /* Effects */
  --shadow-sm: 0 6px 18px rgba(2,6,23,.06);
  --shadow-md: 0 12px 30px rgba(2,6,23,.10);
  --shadow-lg: 0 18px 44px rgba(2,6,23,.14);
  --easing: cubic-bezier(.2,.8,.2,1);
  --duration: 220ms;

  /* Progress / animation */
  --bar-ease: linear; /* default linear as you requested earlier */
}

@media (prefers-color-scheme: dark) {
  :root {
    --bg: #0f1310;
    --surface: #121813;
    --surface-2: #0f140f;
    --text: #e6f2e6;
    --muted: #a9b8a9;
    --border: #243227;

    --shadow-sm: 0 6px 18px rgba(0,0,0,.35);
    --shadow-md: 0 12px 30px rgba(0,0,0,.45);
    --shadow-lg: 0 18px 44px rgba(0,0,0,.55);
  }
}

/* ---------------------------------------------------------
   1) Base & Typography
   --------------------------------------------------------- */
* { box-sizing: border-box; }
*::before,*::after { box-sizing: border-box; }
html { scroll-behavior: smooth; background: var(--bg); color: var(--text); }
body {
  margin: 0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji";
  -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility;
  line-height: 1.55; background: var(--bg); color: var(--text);
  padding: clamp(var(--sp-3), 2vw, var(--sp-6));
}

h1,h2,h3 { color: var(--green-800); line-height: 1.15; letter-spacing: .2px; text-align: center; margin: 0 0 var(--sp-3); }
h1 { font-size: clamp(1.25rem, 2.6vw, 1.6rem); }
h2 { font-size: clamp(1.05rem, 2.2vw, 1.3rem); }
h3 { font-size: clamp(1rem, 1.8vw, 1.15rem); }

p { margin: 0 0 var(--sp-2); color: color-mix(in srgb, var(--text) 85%, var(--muted)); font-size: 0.97rem; }

a { color: var(--green-700); font-weight: 700; text-decoration: none; }
a:hover { text-decoration: underline; text-underline-offset: 3px; }
a:focus-visible { outline: 3px solid color-mix(in srgb, var(--green-500) 60%, white); outline-offset: 2px; border-radius: var(--r-sm); }

.sr-only { position: absolute!important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip: rect(0,0,0,0); white-space:nowrap; border:0; }

.container { max-width: 1000px; margin: 0 auto; }
.app-shell { min-height: 100dvh; display: grid; grid-template-rows: auto 1fr auto; }
main { padding: clamp(var(--sp-4), 3vw, var(--sp-6)); }
.footer { padding: var(--sp-4); text-align: center; color: var(--muted); }
.rule { border: 0; height: 1px; background: var(--border); margin: var(--sp-6) 0; }

/* ---------------------------------------------------------
   2) Header / Nav
   --------------------------------------------------------- */
header, .nav {
  display: flex; align-items: center; justify-content: space-between; gap: 12px;
  padding: 12px 16px; position: sticky; top: 0; z-index: 1000;
  border-bottom: 1px solid color-mix(in srgb, var(--border) 75%, transparent);
  background: color-mix(in srgb, var(--surface) 88%, transparent);
  backdrop-filter: saturate(125%) blur(8px);
}
.brandmark { font-weight: 800; letter-spacing: .2px; }

/* User button & menu (keep your hooks) */
.user-area { position: relative; }
#userBtn, .user-btn {
  display: inline-flex; align-items: center; gap: 10px;
  padding: 8px 12px; background: var(--surface); color: var(--text);
  border: 1px solid var(--border); border-radius: var(--r-pill); cursor: pointer;
  box-shadow: var(--shadow-sm); transition: background var(--duration) var(--easing), transform var(--duration) var(--easing);
}
#userBtn:hover, .user-btn:hover { background: var(--surface-2); transform: translateY(-1px); }
#userBtn:active, .user-btn:active { transform: translateY(0); }
#userBtn:focus-visible, .user-btn:focus-visible { outline: 3px solid color-mix(in srgb, var(--green-600) 55%, #fff); outline-offset: 2px; }
#userBtn.menu-open, .user-btn[aria-expanded="true"] { background: var(--green-50); border-color: var(--green-300); }

#userMenu, .menu {
  position: absolute; right: 0; top: calc(100% + 8px);
  min-width: 200px; padding: 8px; display: none;
  background: var(--surface); border: 1px solid var(--border); border-radius: 14px;
  box-shadow: var(--shadow-lg); z-index: 1500; text-align: center;
}
#userMenu.show { display: block; }
.menu-item, #userMenu button {
  width: 100%; text-align: left; padding: 10px 12px; background: transparent; border: 0; border-radius: 10px; cursor: pointer;
}
.menu-item:hover, #userMenu button:hover { background: rgba(0,0,0,.05); }
.menu-item.danger { color: #b00020; }

/* Inline userInfo helper (if used) */
#userInfo { position: absolute; right: 20px; top: 50%; transform: translateY(-50%); display: inline-flex; align-items: center; gap: 10px; }

/* ---------------------------------------------------------
   3) Cards & Surfaces
   --------------------------------------------------------- */
.card, .species-item, .herbarium-card, .modal-content {
  background: var(--surface); border: 1px solid var(--border); border-radius: var(--r-lg);
  padding: var(--sp-5); box-shadow: var(--shadow-md); transition: box-shadow var(--duration) var(--easing), transform var(--duration) var(--easing);
}
.card:hover, .species-item:hover, .herbarium-card:hover { box-shadow: var(--shadow-lg); transform: translateY(-1px); }

/* Species list layout */
.species-item { display: flex; flex-direction: column; margin-bottom: var(--sp-4); }
.card-content { display: grid; grid-template-columns: 150px 1fr; align-items: center; gap: var(--sp-4); }
.species-image-container { width: 150px; position: relative; }
.species-image { width: 100%; height: auto; object-fit: cover; border-radius: var(--r-md); }
.species-info { font-size: 0.95rem; text-align: left; }
.species-info p { margin: 2px 0; color: var(--text); }
.species-actions { display: flex; align-items: center; gap: 10px; margin-top: 8px; }

/* Wiki thumb chip */
.wiki-thumb {
  position: absolute; left: 8px; bottom: 8px; display: grid; grid-template-columns: auto 1fr; gap: 6px; align-items: center;
  background: color-mix(in srgb, var(--surface) 92%, transparent); border: 1px solid var(--border); border-radius: 12px;
  padding: 6px; box-shadow: var(--shadow-md);
}
.wiki-label { font-size: 11px; color: var(--muted); padding: 2px 6px; border: 1px solid var(--border); border-radius: var(--r-pill); }
.wiki-img-wrap { width: 46px; height: 46px; border-radius: 10px; overflow: hidden; display: grid; place-items: center; background: var(--surface-2); }
.wiki-img-wrap img { width: 100%; height: 100%; object-fit: cover; display: block; }

/* Herbarium */
.herbarium-item { width: 100%; }
.herbarium-card { grid-template-columns: 84px 1fr; gap: 12px; align-items: center; padding: 12px; }
.herbarium-img { width: 84px; height: 84px; border-radius: 12px; overflow: hidden; background: var(--surface-2); display: grid; place-items: center; }
.herbarium-img img { width: 100%; height: 100%; object-fit: cover; display: block; }
.herbarium-info .herbarium-name { margin: 0 0 4px 0; }
.herbarium-info .herbarium-date { margin: 0; font-size: 12px; color: var(--muted); }

/* ---------------------------------------------------------
   4) Forms & Inputs
   --------------------------------------------------------- */
.form-grid { display: grid; gap: var(--sp-3); }
.input {
  width: 100%; padding: 12px 12px; background: var(--surface); color: var(--text);
  border: 1px solid var(--border); border-radius: var(--r-md); transition: border-color var(--duration) var(--easing), box-shadow var(--duration) var(--easing);
}
.input:focus { outline: none; border-color: var(--green-300); box-shadow: 0 0 0 4px color-mix(in srgb, var(--green-200) 60%, transparent); }
.validation-feedback { margin-top: var(--sp-3); font-size: .9rem; color: var(--muted); }
.muted { color: var(--muted); }

/* File input trigger (“Add picture”) */
input[type="file"]{ display:none; }
.label-file { display:inline-flex; align-items:center; gap:10px; padding: 10px 14px; border-radius: var(--r-md); cursor: pointer; background: var(--surface); color: var(--text); border: 1px dashed var(--border); box-shadow: var(--shadow-sm); transition: background var(--duration) var(--easing), border-color var(--duration) var(--easing), transform var(--duration) var(--easing); }
.label-file:hover { background: var(--green-50); border-color: var(--green-300); transform: translateY(-1px); }
.label-file:active { background: var(--green-100); border-color: var(--green-400); transform: translateY(0); }

/* ---------------------------------------------------------
   5) Buttons
   --------------------------------------------------------- */
button, .points-btn, .validate-species-btn, #userMenu button {
  --btn-fg: #fff; color: var(--btn-fg); font-weight: 800; letter-spacing: .2px; width: 100%;
  padding: 10px 14px; margin: 6px 0; border: 0; border-radius: var(--r-md); cursor: pointer;
  background: linear-gradient(180deg, var(--green-500), var(--green-600));
  box-shadow: 0 2px 0 rgba(0,0,0,.05), 0 10px 20px rgba(34,197,94,.12);
  transition: transform var(--duration) var(--easing), filter var(--duration) var(--easing), box-shadow var(--duration) var(--easing);
}
button:hover, .points-btn:hover, .validate-species-btn:hover, #userMenu button:hover { filter: brightness(1.02); transform: translateY(-1px); }
button:active, .points-btn:active, .validate-species-btn:active, #userMenu button:active { transform: translateY(0); filter: brightness(.98); }
button:focus-visible, .points-btn:focus-visible, .validate-species-btn:focus-visible { outline: 3px solid color-mix(in srgb, var(--green-500) 60%, white); outline-offset: 2px; }

/* Variants */
.primary { background: linear-gradient(180deg, var(--green-500), var(--green-600)); color: #fff; border: none; }
.secondary { background: var(--surface); color: var(--text); border: 1px solid var(--border); box-shadow: var(--shadow-sm); }

/* ---------------------------------------------------------
   6) Modals
   --------------------------------------------------------- */
.modal { display:none; position: fixed; inset: 0; z-index: 1000; backdrop-filter: blur(8px); background: color-mix(in srgb, #000 28%, transparent); }
.modal[open], .modal.show { display: grid; place-items: center; }
.modal-content { width: min(92vw, 520px); text-align: center; border-radius: var(--r-xl); animation: modalIn .2s var(--easing); position: relative; overflow: hidden; }
.close { position: absolute; right: 14px; top: 10px; color: var(--muted); font-size: 28px; font-weight: 800; cursor: pointer; line-height: 1; border-radius: 10px; }
.close:hover, .close:focus { color: var(--text); background: var(--surface-2); }
@keyframes modalIn { from { opacity: 0; transform: translateY(8px) scale(.98);} to { opacity: 1; transform: translateY(0) scale(1);} }

/* ---------------------------------------------------------
   7) Result Modal: Points, Levels, Badges
   --------------------------------------------------------- */
.result-modal .modal-content.result { overflow: hidden; }
.result-head { display: flex; flex-direction: column; gap: 6px; margin-bottom: 10px; }
.result-points .big { font-size: 44px; font-weight: 900; letter-spacing: .5px; line-height: 1.05; }

.details { display: grid; gap: 6px; margin-top: 8px; }
.detail-line { display: flex; justify-content: space-between; font-size: 14px; background: var(--surface-2); border: 1px solid var(--border); padding: 8px 10px; border-radius: 12px; }

/* Progress rails */
.progress-rail, #resultModal #resultLevelProgressContainer {
  height: 10px; background: color-mix(in srgb, var(--border) 80%, transparent); border-radius: var(--r-pill); overflow: hidden;
}
.progress-bar, #resultModal #resultLevelProgressBar {
  height: 100%; width: 0%; background: linear-gradient(90deg, var(--green-500), var(--green-700)); transition: width .15s var(--bar-ease);
}

/* Level badges */
.level-badge {
  display: inline-flex; align-items: center; gap: 8px; justify-content: center; line-height: 1;
  padding: 6px 12px; border-radius: var(--r-pill); border: 1px solid var(--border);
  background: #1f2a22; color: #fff; font-weight: 900; font-size: 12px; position: relative; overflow: hidden; box-shadow: var(--shadow-sm);
}
.beginner-level { background: linear-gradient(180deg, #4CAF50, #2f8e49); }
.intermediate-level { background: linear-gradient(180deg, #ffb24d, #d87f07); }
.expert-level { background: linear-gradient(180deg, #ef4444, #b91c1c); }

/* Points badge (rarity chips) */
.points-badge { display: inline-flex; align-items: center; gap: 10px; padding: 10px 14px; border-radius: var(--r-pill); border: 1px solid var(--border); font-weight: 800; box-shadow: var(--shadow-sm); background: var(--surface); }
.points-badge .label { font-size: 12px; opacity: .75; }
.points-badge .value { font-size: 22px; }

.common-points   { background: linear-gradient(180deg, #9aa3a7, #7b8488); color: #fff; }
.rare-points     { background: linear-gradient(180deg, #3aa0ff, #1e7fe0); color: #fff; }
.epic-points, .legendary-points { position: relative; display: inline-flex; align-items: center; overflow: hidden; border-radius: var(--r-pill); isolation: isolate; clip-path: inset(0 round var(--r-pill)); contain: paint; color: #fff; }
.epic-points { background: linear-gradient(180deg, #b46ad3, #9c27b0); }
.legendary-points { background: linear-gradient(180deg, #ffe27a, #ffd54d); color: #111; }

/* Subtle sheen (disabled with reduced motion) */
.epic-points::after, .legendary-points::after {
  content: ""; position: absolute; inset: 0; pointer-events: none; z-index: 1;
  background: linear-gradient(120deg, transparent 0%, rgba(255,255,255,0) 38%, rgba(255,255,255,.55) 50%, rgba(255,255,255,0) 62%, transparent 100%);
  background-size: 250% 100%; animation: sheen 4s linear infinite; mix-blend-mode: overlay;
}
@keyframes sheen { 0%{ background-position:-150% 0; } 30%{ background-position:150% 0; } 100%{ background-position:150% 0; } }

/* Badge list */
.badges { display:flex; gap:8px; flex-wrap:wrap; margin-top: 6px; justify-content: center; }
.badge { display:inline-flex; align-items:center; gap:6px; font-size:12px; letter-spacing:.01em; color: var(--green-800); background: var(--surface); border:1px solid var(--border); padding: 6px 10px; border-radius: var(--r-pill); box-shadow: var(--shadow-sm); font-weight: 700; opacity:0; transform: translateY(8px) scale(.98); transition: all .22s var(--easing); }
.badge.in { opacity:1; transform: translateY(0) scale(1); }
.badges.big { gap:12px; margin-top: 12px; }
.badge.big { border-radius: 18px; padding: 10px 14px; font-weight: 900; opacity:0; transform: translateY(10px) scale(.95) rotate(-1deg); }
.badge.big.in { opacity:1; transform: translateY(0) scale(1) rotate(0); animation: popBadge .35s ease-out; }
@keyframes popBadge { 0%{ transform: translateY(12px) scale(.9);} 60%{ transform: translateY(-2px) scale(1.06);} 100%{ transform: translateY(0) scale(1);} }

/* Loading / spinner */
.loading-strip { height: 6px; background: #eef2f7; border-radius: var(--r-pill); overflow:hidden; }
.loading-bar { width: 40%; height: 100%; animation: loadmove 1s infinite; }
@keyframes loadmove { 0%{ transform: translateX(-100%);} 100%{ transform: translateX(300%);} }
.loading-track { position: relative; width: 100%; height: 6px; border-radius: var(--r-pill); background: #eef2f7; overflow: hidden; }
.loading-indeterminate { position: absolute; left: -40%; width: 40%; height: 100%; background: linear-gradient(90deg, rgba(16,185,129,.2), rgba(16,185,129,.65), rgba(16,185,129,.2)); animation: indeterminate 1.2s ease-in-out infinite; border-radius: var(--r-pill); }
@keyframes indeterminate { 0%{ left:-40%; width:40%; } 50%{ left:20%; width:60%; } 100%{ left:100%; width:40%; } }
.spinner { width: 26px; height: 26px; border-radius: 50%; border: 3px solid #e5e7eb; border-top-color: var(--green-600); animation: spin .9s linear infinite; position: fixed; left: 50%; top: 50%; transform: translate(-50%, -50%); z-index: 1000; box-shadow: var(--shadow-sm); }
@keyframes spin { to { transform: rotate(360deg); } }

/* ---------------------------------------------------------
   8) Missions / Levels embellishments
   --------------------------------------------------------- */
.mission-title { font-size: 1.1rem; font-weight: 900; text-align: center; margin-bottom: var(--sp-3); color: var(--green-800); }
.mission-level { color: #fff; margin-top: var(--sp-2); display:inline-flex; align-items:center; gap:8px; padding:4px 10px; border-radius: var(--r-pill); font-size:12px; border:1px solid var(--border); box-shadow: inset 0 -2px 0 rgba(0,0,0,.08); }

/* Tree / invasive / flowering badges */
.tree-badge { background: color-mix(in srgb, var(--green-100) 70%, white); color: var(--green-700); border-color: color-mix(in srgb, var(--green-300) 60%, white); }
.invasive-badge { background: var(--danger-100); color: var(--danger-500); border-color: color-mix(in srgb, var(--danger-500) 25%, white); }
.flowering-badge { background: var(--warn-100); color: var(--warn-600); border-color: color-mix(in srgb, var(--warn-600) 20%, white); }

/* Fancy level pulse (used only on level-up) */
@keyframes levelPulse { 0%{ transform: scale(1); box-shadow:none; } 40%{ transform: scale(1.02); box-shadow: 0 20px 60px rgba(16,185,129,.25);} 100%{ transform: scale(1); box-shadow:none; } }
.result-modal .modal-content.result.levelup { animation: levelPulse .8s ease; }

/* ---------------------------------------------------------
   9) Responsive
   --------------------------------------------------------- */
@media (max-width: 768px) {
  body { padding: var(--sp-4); }
  .card-content { grid-template-columns: 110px 1fr; gap: var(--sp-3); }
  .species-image-container { width: 110px; }
}
@media (max-width: 480px) {
  header { padding: var(--sp-3) var(--sp-4); }
  .card-content { grid-template-columns: 84px 1fr; }
  .species-image-container { width: 84px; }
}
@media (max-width: 380px) { .level-badge { font-size: 11.5px; padding: 5px 10px; } }

/* ---------------------------------------------------------
   10) Motion safety
   --------------------------------------------------------- */
@media (prefers-reduced-motion: reduce) {
  * { animation: none !important; transition: none !important; }
  .epic-points::after, .legendary-points::after { animation: none; opacity: 0; }
}
